# Модуль системы модерации: Заявки и обработка

## Обзор архитектуры

Система была полностью переработана для упрощения процесса модерации. Теперь решение по заявке принимает один модератор (первый, кто отреагировал), с расширенными возможностями для обработки заявок.

## Компоненты системы

### 1. CApplicationVoteSystem

Основная система обработки заявок с расширенными возможностями для модераторов.

**Ключевые методы:**
- `Initialize()` - инициализация обработчиков событий
- `ProcessButtonClick()` - обработка действий модераторов
- `ProcessFormSubmit()` - обработка подачи заявки
- `ShowModeratorOptions()` - показ опций для модератора
- `ShowRejectionReasons()` - показ причин отказа
- `FinalizeApplication()` - завершение обработки заявки

### 2. Структура SApplicationVoteData

Содержит данные о заявке:

**Поля:**
- `m_targetUserId` - ID пользователя, подавшего заявку
- `m_processedBy` - ID модератора, обработавшего заявку
- `m_userData` - данные пользователя
- `m_status` - статус заявки ("pending", "accepted", "rejected")
- `m_rejectionReason` - причина отказа

## Процесс работы системы

### Подача заявки
1. Пользователь заполняет форму заявки
2. Создается сообщение в канале модерации
3. Заявка добавляется в активный список

### Обработка модератором
1. Модератор нажимает кнопку "Принять" или "Отклонить"
2. Система показывает дополнительные опции:
   - Для принятия: подтверждение или редактирование сообщения
   - Для отклонения: выбор причины или ввод своей причины

### Завершение обработки
1. При принятии заявки:
   - Пользователь добавляется в базу данных
   - Назначается роль участника клана
   - Отправляется уведомление в ЛС

2. При отклонении заявки:
   - Указывается причина отказа
   - Отправляется уведомление с причиной в ЛС
   - Заявка архивируется

## Преимущества новой системы

1. **Упрощенный процесс** - решение принимает один модератор
2. **Гибкие опции** - различные варианты обработки заявок
3. **Прозрачность** - запись кто обработал заявку и по какой причине
4. **Улучшенная коммуникация** - отправка детальных уведомлений пользователям
5. **Архивация** - сохранение истории обработки заявокЙ